<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Get This Get This — Chaotic Crumble (p5.js)</title>

<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">

<style>
  html, body { margin:0; height:100%; background:#fff; color:#000; }
  body { font-family: "Space Grotesk", system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
  canvas { display:block; }

  /* HUD stays fixed until crumble starts */
  .hud {
    position: fixed;
    top: 14px; left: 24px; right: 24px;
    display:flex;
    justify-content:space-between;
    pointer-events:none;
    transition: opacity .4s ease;
  }
  .hud.fade {
    opacity:0;
  }
  .hud .title {
    font-weight:700;
    font-size: clamp(22px, 3.8vw, 48px);
    letter-spacing:.4px;
  }
  .hud .hint {
    align-self:flex-end;
    opacity:.35;
    font-size: clamp(11px, 1.2vw, 14px);
  }
</style>
</head>
<body>

<div class="hud" id="hud">
  <div class="title" id="hudTitle">Get This Get This</div>
  <div class="hint" id="hudHint">Press “C” to crumble</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
<script>
/* ------------------------------------------
   DESIGN SPACE
   ------------------------------------------ */
const DESIGN_W = 1846;
const DESIGN_H = 768;

let scaleF = 1;

/* ------------------------------------------
   POEM LINES
   ------------------------------------------ */
const leftLines = [
  { text: 'And so she said “j u m p  o f f  t h e  c l i f f”', x: 60,  y: 160, size: 56 },
  { text: 'But get this She Didn’t naturally',                 x: 60,  y: 230, size: 56 },
  { text: 'the audience was mad',                              x: 60,  y: 300, size: 64 },
  { text: 'They didn’t pay',                                   x: 60,  y: 372, size: 56 },
  { text: 'good shxt',                                         x: 60,  y: 444, size: 64 },
  { text: 'for this money',                                    x: 60,  y: 516, size: 56 }
];

const rightLines = [
  { text: '“Like are you kidding me?” Her said',        x: 900,  y: 520, size: 56 },
  { text: '“Madness, this is sheer madness” and',       x: 840,  y: 590, size: 64 },
  { text: 'They lit the stage aflame',                  x: 1180, y: 662, size: 56 }
];

/* ------------------------------------------
   NEW: HUD TEXT LINES
   ------------------------------------------ */
const hudLines = [
  { text: 'Get This Get This', x: 60,  y: -40, size: 72 }
];

/* ------------------------------------------
   TIMING
   ------------------------------------------ */
const msPerChunk = 350;
const msHoldBeforeCrumble = 350;

let crumble = false;
let crumbleStartTime = 0;

let allLetters = [];

/* ------------------------------------------
   LETTER CLASS
   ------------------------------------------ */
class Letter {
  constructor(ch, x, y, size, revealAt) {
    this.ch = ch;
    this.pos = createVector(x, y);
    this.vel = createVector(0,0);
    this.rot = 0;
    this.spin = 0;
    this.size = size;
    this.revealAt = revealAt;
    this.visible = false;
    this.alpha = 255;

    this.hasCrumbleImpulse = false;
    this.localCrumbleDelay = random(0,600);
    this.sideDrift = random(-0.15, 0.15);
  }

  update(dt) {
    const now = millis();

    if (!this.visible && now >= this.revealAt) this.visible = true;

    if (this.visible && crumble) {

      if (!this.hasCrumbleImpulse && now >= crumbleStartTime + this.localCrumbleDelay) {
        this.vel.x += random(-4,4);
        this.vel.y += random(-5,-1);
        this.spin  += random(-0.1,0.1);
        this.hasCrumbleImpulse = true;
      }

      if (this.hasCrumbleImpulse) {
        this.vel.y += 0.85;
        this.vel.x += this.sideDrift;
        this.vel.mult(1 - 0.03);
        this.pos.add(this.vel);
        this.rot += this.spin;
        this.alpha = max(0, this.alpha - dt * 0.3);
      }
    }
  }

  draw() {
    if (!this.visible) return;
    push();
    translate(this.pos.x, this.pos.y);
    rotate(this.rot);
    fill(0, this.alpha);
    textSize(this.size);
    text(this.ch, 0, 0);
    pop();
  }
}

/* ------------------------------------------
   BUILD LETTERS
   ------------------------------------------ */
function buildBlock(lines, startDelay=0) {
  let t = startDelay;

  lines.forEach(line => {
    textSize(line.size);
    let x = line.x, y = line.y;

    for (let ch of line.text) {
      const w = textWidth(ch);
      if (ch !== ' ') allLetters.push(new Letter(ch, x, y, line.size, t));
      x += w;
    }

    t += msPerChunk;
  });

  return t;
}

/* ------------------------------------------
   SETUP
   ------------------------------------------ */
function setup() {
  createCanvas(windowWidth, windowHeight);
  textFont("Space Grotesk");
  textAlign(LEFT, BASELINE);

  let t = buildBlock(leftLines, 0);
  t = buildBlock(rightLines, t + msPerChunk * 0.4);

  // HUD letters added LAST so they crumble last
  buildBlock(hudLines, t);

  // Auto crumble
  setTimeout(() => triggerCrumble(), t + msHoldBeforeCrumble);
}

/* ------------------------------------------
   CRUMBLE TRIGGER
   ------------------------------------------ */
function triggerCrumble() {
  if (crumble) return;
  crumble = true;
  crumbleStartTime = millis();

  // fade out DOM HUD so it doesn't overlap
  document.getElementById("hud").classList.add("fade");
}

function keyPressed() {
  if (key === 'c' || key === 'C') {
    triggerCrumble();
  }
}

/* ------------------------------------------
   DRAW
   ------------------------------------------ */
function draw() {
  scaleF = min(width / DESIGN_W, height / DESIGN_H);
  background(255);

  const verticalOffset = -160;
  const horizontalOffset = -40;

  push();
  translate(
    (width - DESIGN_W * scaleF) / 2 + horizontalOffset * scaleF,
    (height - DESIGN_H * scaleF) / 2 + verticalOffset * scaleF
  );
  scale(scaleF);

  const dt = deltaTime;
  allLetters.forEach(l => {
    l.update(dt);
    l.draw();
  });

  pop();
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
}
</script>

</body>
</html>
